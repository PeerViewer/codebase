<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>⇔ PeerViewer</title>
  </head>
  <body>
    <div class="container">
        <header>
	   <p class="logo">⇔</p>
           <h1>PeerViewer</h1>
           <p>The free peer-to-peer TeamViewer solution.</p>
        </header>
        <div class="main-content">
            <div class="column" id="column1">
                <h2>Allow Remote Control</h2>
                <!-- <button class="bluebutton" onclick="runServer()">Run Server</button> -->
		<p id="youridlabel">YOUR ID:</p>
                <div id="pubkey"></div>
		<div id="serverhelptext">When you give your ID to someone running PeerViewer, they can operate your computer until you close this window.</div>
		<div id="serverstatus">Initializing...</div>
            </div>
            <div class="column" id="column2">
                <h2>Control Remote Computer</h2>
		<p>
                <label for="connectto">Partner ID:</label>
                <input type="text" id="connectto" name="connectto"/>
		</p>
                <button class="bluebutton" onclick="runClient()">CONNECT</button>
		<div id="clientstatus">Ready to connect.</div>
            </div>
        </div>
        <footer>
            <p>PeerViewer © 2023 - powered by HolePunch</p>
        </footer>
    </div>
    <script>
        const { ipcRenderer } = require('electron');
        function runServer() {
          ipcRenderer.send('run-server');
          console.log("run-server done");
        }
        function runClient() {
          ipcRenderer.send('run-client', document.getElementById('connectto').value);
          console.log("run-client done");
        }
        // Listen for the response from the main process
        ipcRenderer.on('run-client-result', (event, result) => {
          console.log("got result:" + result);
        });
        ipcRenderer.on('run-server-result', (event, result) => {
          console.log("got result:" + result);
        });
        ipcRenderer.on('run-server-pubkey', (event, result) => {
          console.log("run-server-pubkey: " + result);
          document.getElementById("pubkey").innerHTML = result;
        });
	ipcRenderer.on('run-server-log', (event, result) => {
          console.log("run-server-log: " + result);
          document.getElementById("serverstatus").innerHTML = result;
        });
	ipcRenderer.on('run-client-log', (event, result) => {
          console.log("run-client-log: " + result);
          document.getElementById("clientstatus").innerHTML = result;
        });

	// run server automatically
	runServer();
    </script>
  </body>
</html>
