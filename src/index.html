<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>⇔ PeerViewer - peer-to-peer remote desktop and support solution, completely free for unlimited personal and commercial use.</title>
    <!-- This stylesheet is only needed for the website, and will return a 404 in the Electron app, as it's bundled using webpack: -->
    <link rel="stylesheet" href="index.css">
  </head>
  <body>
    <div class="container">
        <header>
	   <p class="logo">⇔</p>
           <h1>PeerViewer</h1>
           <p>The peer-to-peer remote desktop and support solution, completely free for unlimited personal and commercial use.</p>
        </header>
        <div class="menu">
            <div class="menuitem"><button class="menubutton menubuttonselected" onclick="menuChange(event,0)">Remote</button></div>
            <div class="menuitem"><button class="menubutton" onclick="menuChange(event,1)">More Features</button></div>
            <div class="menuitem"><button class="menubutton" onclick="menuChange(event,2)">Contact</button></div>
            <!-- <div class="menuitem"><button class="menubutton" onclick="menuChange(event,3)">Tip Jar</button></div> -->
            <div class="menuitem"><button class="menubutton" onclick="menuChange(event,4)">Donate</button></div>
            <div class="menuitem"><button class="menubutton" onclick="menuChange(event,5)">About</button></div>
        </div>
        <div class="main-content" id="content0">
            <div class="coverremotecontrol">
                <a href="https://github.com/PeerViewer/codebase/releases/" class="bluebutton downloadbutton"><div>Download PeerViewer to get started</div></a>
            </div>
            <div class="column" id="column1">
                <h2>Allow Remote Control</h2>
                <label for="pubkey">YOUR ID:</label>
                <input type="text" name="pubkey" id="pubkey" disabled size="43">
                <a href="#copy" onclick="javascript:copyYourId();"><img width="26" src="../images/copy-icon.png" class="copyicon"></a>
		<div id="serverhelptext">When you give your ID to someone running PeerViewer, they can operate your computer until you close this window.</div>
		<!-- <button class="bluebutton" onclick="runServer()">Run Server</button> -->
		<div id="serverstatus">Initializing...</div>
            </div>
            <div class="column" id="column2">
                <h2>Control Remote Computer</h2>
		<p>
                <label for="connectto">Partner ID:</label>
                <input type="text" id="connectto" name="connectto" size="43" onKeyPress="javascript:checkSubmit(event)"/>
		</p>
                <button class="bluebutton connectbutton" onclick="runClient()">CONNECT</button>
		<div id="clientstatus">Ready to connect.</div>
            </div>
        </div>
        <div class="main-content" id="content1">
	    <div class="onecolumn">
	        <p>We'd love to know which feature to focus on next. What would you like to see? Now you can vote... with your wallet!</p>
                <p>Just scan the QR code of the feature(s) you want with a Bitcoin Lightning wallet and send however much you like.</p>
		<p>We're using this as an anti-spam mechanism, a way to weigh the votes, and a way to fund development.</p>
		<p>The minimum amount is 1 satoshi, and the maximum is 10 Bitcoin. Every sat counts!</p>
		<div id="featuregallery">
		<!-- This gets filled up by JavaScript. -->
		</div>
		<button class="bluebutton" onClick="menuChange(event,3)">Feel free to request a different feature using the contact form</button>
            </div>
	</div>
        <div class="main-content" id="content2">
		<iframe class="contactticketform" width="1200" height="620" src="https://legend.lnbits.com/lnticket/ejBSMY2x8XfNUqPHtmoCmc" title="Create Support Ticket using lnbits"></iframe>
		<!-- <a href="https://legend.lnbits.com/lnticket/ejBSMY2x8XfNUqPHtmoCmc">Open Form</a> -->
	</div>
        <div class="main-content" id="content3">
		<!-- 605 height is needed to avoid scroll bars -->
		 <iframe width="1200" height="610" src="https://legend.lnbits.com/tipjar/1114" title="Tip Jar"></iframe>
	</div>
        <div class="main-content" id="content4">
	     <div class="onecolumn">
		<p>As you know, writing and maintaining quality software is not cheap.</p>
		<p>We are aiming to keep this project well-maintained, bug-free, and reliable long-term.</p>
		<p>Therefore, your generous donations are always appreciated.</p>
                <p>Just scan the QR code with a Bitcoin Lightning wallet and send however much you like.</p>
		<p>Thank you!</p>
		<a href="lightning:LNURL1DP68GURN8GHJ7MR9VAJKUEPWD3HXY6T5WVHXXMMD9AKXUATJD3CZ7DN8GUE4WCGS0D0DN"><img src="../images/LNURL1DP68GURN8GHJ7MR9VAJKUEPWD3HXY6T5WVHXXMMD9AKXUATJD3CZ7DN8GUE4WCGS0D0DN.png" class="donationqr"/></a>
	    </div>
	</div>
        <div class="main-content" id="content5">
	     <div class="onecolumn">
		<p>PeerViewer <span id="peerviewerversion"></span> is a remote desktop and support solution, completely free for unlimited personal and commercial use.</p>
		<p>Under the hood, it uses direct (peer-to-peer) connections between the participants.</p>
		<p>This was recently made possible by the advanced holepunching techniques, made by the <a href="https://holepunch.to" target="_blank">HolePunch</a> company.</p>
		<!--
		<h3>Why build an alternative to TeamViewer?</h3>
		<p>TeamViewer works well and is very popular as a remote desktop and support program, but it's not free for commercial use.<p>
		<p>Users report frequent disconnections, possibly due to TeamViewer monitoring the sessions and terminating them if they violate the terms of service.</p>
		<p>We can do better.</p>
		-->
		<h3>Why peer-to-peer?</h3>
		<p>Traditionally, when you use network apps such as TeamViewer, place audio and video calls or share files, your data is going through intermediate servers which are expensive to host, can harm your privacy, increase latency and consume additional bandwidth.</p>
		<p>Peer-to-peer solutions such as PeerViewer have the advantage of:
		<ul>
			<li>Being the highest bandwidth AND lowest latency way of establishing a network connection.</li>
			<li>Ensuring maximum privacy for all participants.</li>
			<li>Being low cost, making it possible to survive on a pay-what-you-can/voluntary/donation basis.</li>
			<li>Minimizing time-to-market and allowing for quick MVP's without a lot of server-side datacenter setup work.</li>
		</ul>
		<h3>Building blocks</h3>
		<p>We're lucky to be standing on the shoulders of giants to pull this off.</p>
		<p>Here's a list of some key, free and open-source technologies that make this possible:</p>
		<ul>
			<li>HolePunch, for establishing direct peer-to-peer connections.</li>
			<li>LNBits, for quickly building reusable payment QR codes using the LNURLp standard.</li>
			<li>Electron, for building standalone applications using open web standards.</li>
			<li>Bitcoin and Lightning, for accepting payments without needing anyone's permission or approval.</li>
		</ul>
		<button class="bluebutton" onClick="menuChange(event,2)">If you like this project, or have suggestions, let us know!</button>
	    </div>
	</div>
        <footer>
            <p><a href="https://peerviewer.org" target="_blank">PeerViewer</a> © 2023 - powered by <a href="https://holepunch.to/" target="_blank"><img class="holepunchlogo" src="../images/holepunch-logo.svg"></a></p>
        </footer>
    </div>
    <script>
    function adaptForWeb() {
      Array.from(document.getElementsByClassName("coverremotecontrol")).forEach(button => {
        button.style.display = "block";
      });
    }
    function startup() {
      populateFeatureGallery();
      try {
        const process = require('node:process');
        console.log(process.platform);
        runServer(); // run server automatically at startup
	/*
        const electronVersion = process.versions.electron;
        console.log("electronVersion = " + electronVersion);
        const appVersion = process.env.npm_package_version; // This only works when running with npm start, not in an AppImage release :/
        console.log("appVersion = " + appVersion);
        document.getElementById('peerviewerversion').innerHTML = "version " + appVersion;
	*/
      } catch (e) {
         console.log('Caught error in require of node:process:');
         console.log(e);
         adaptForWeb();
      }
    }
    function menuChange(event,itemnr) {
      console.log("changing menu " + itemnr);
      // Show the right content
      for (let i=0;i<6;i++) {
        let tohide = document.getElementById("content" + i)
        if (tohide) tohide.style.display = "none";
      }
      let toshow = document.getElementById("content" + itemnr)
      if (toshow) toshow.style.display = "flex";
      // Color the right menu buttons
      Array.from(document.getElementsByClassName("menubutton")).forEach(button => {
        button.classList.remove("menubuttonselected");
      });
      event.target.classList.add("menubuttonselected");
    }

    function populateFeatureGallery() {
      const features = [["Windows Support", "If you'd like to remote control Windows machines, or use a Windows machine for control, you need this!", "LNURL1DP68GURN8GHJ7MR9VAJKUEPWD3HXY6T5WVHXXMMD9AKXUATJD3CZ73NXX438JJCDQW26S"],
                        ["MacOS Support", "If you'd like to remote control MacOS machines, or use an Apple for control, you need this!", "LNURL1DP68GURN8GHJ7MR9VAJKUEPWD3HXY6T5WVHXXMMD9AKXUATJD3CZ76R6GYMKVUC3WQLMU"],
                        ["Open-Source the Code", "Should we open up the source code? Show how much you REALLY want it!", "LNURL1DP68GURN8GHJ7MR9VAJKUEPWD3HXY6T5WVHXXMMD9AKXUATJD3CZ7EJXDFFKSAC3TS7PU"],
                        ["Integrated Bitcoin Lightning Wallet", "Allowing you 'stream' satoshis (for example: pay or get paid per minute) to provide remote support or share your computer.", "LNURL1DP68GURN8GHJ7MR9VAJKUEPWD3HXY6T5WVHXXMMD9AKXUATJD3CZ7C6G0P58S3C2C2P4Q"],
                        ["View-Only Mode", "A View-Only mode might be nice to be able to share your desktop, without having the other party control it.", "LNURL1DP68GURN8GHJ7MR9VAJKUEPWD3HXY6T5WVHXXMMD9AKXUATJD3CZ7CFKDFUXXSGUDGTFU"]];
      let featuresHTML = "";
      for (let featurenr=0; featurenr<features.length; featurenr++) {
        featuresHTML += '<div class="feature" id="feature' + featurenr + '"><h3>' + features[featurenr][0] + '</h3><p>' + features[featurenr][1] + '</p><a href="lightning:' + features[featurenr][2] + '"><img src="../images/' + features[featurenr][2] + '.png" alt="yes"/></a></div>';
      }
      document.getElementById("featuregallery").innerHTML = featuresHTML;
    }

    function copyYourId() {
      let yourIdInput = document.getElementById("pubkey");
      yourIdInput.select();
      yourIdInput.setSelectionRange(0, 99999); // For mobile devices
      navigator.clipboard.writeText(yourIdInput.value);
      document.getElementById("serverstatus").innerHTML = "Copy successful. You can paste your ID in a message to your partner.";
      console.log("Copied your ID: " + yourIdInput.value);
    }
    function checkSubmit(e) {
      if (e && e.keyCode == 13) {
        console.log("Return pressed on partner ID field, connecting...");
        runClient();
      }
    }

    function download() {
      location.href = "https://github.com/PeerViewer/codebase/releases/";
    }
    startup();
    </script>
  </body>
</html>
